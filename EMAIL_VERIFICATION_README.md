# 邮箱验证码功能说明

## 功能概述

为翻译平台添加了邮箱验证码功能，确保用户提供的邮箱地址是有效的，并且用户能够接收到系统发送的邮件通知。

## 功能特点

### 1. 智能显示逻辑
- 验证码输入框和发送按钮默认隐藏
- 只有当用户勾选"邮件通知"选项时才显示
- 邮件通知默认不勾选

### 2. 多语言支持
- 支持中文、日文、英文、俄文、韩文、法文
- 所有验证码相关的提示信息都有对应的多语言翻译

### 3. 安全验证
- 验证码为6位数字
- 验证码有效期为5分钟
- 验证成功后自动删除验证码，防止重复使用

### 4. 用户体验优化
- 发送验证码后有60秒倒计时，防止频繁发送
- 实时邮箱格式验证
- 友好的错误提示信息

## 应用场景

### 注册页面
- 用户注册时如果勾选邮件通知，需要验证邮箱
- 验证码发送到用户填写的邮箱地址

### 编辑资料页面
- 用户修改邮箱地址时，如果启用了邮件通知，需要验证新邮箱
- 只有邮箱发生变化且启用邮件通知时才需要验证

## 技术实现

### 后端功能
1. **验证码生成**: `generate_verification_code()` - 生成6位数字验证码
2. **验证码存储**: `store_verification_code()` - 存储验证码和过期时间
3. **验证码验证**: `verify_verification_code()` - 验证用户输入的验证码
4. **邮件发送**: `send_verification_email()` - 发送验证码邮件

### API接口
- `POST /send_verification_code` - 发送验证码API
  - 请求体: `{"email": "user@example.com"}`
  - 响应: `{"success": true/false, "message": "提示信息"}`

### 前端功能
1. **动态显示**: 根据邮件通知开关状态显示/隐藏验证码区域
2. **实时验证**: 邮箱输入时实时检查是否需要验证
3. **倒计时**: 发送验证码后60秒倒计时
4. **表单验证**: 提交前检查验证码是否已输入

## 配置要求

### 邮件服务器配置
需要在环境变量中配置SMTP服务器信息：
```
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your_email@example.com
SMTP_PASS=your_password
SMTP_USE_TLS=true
FROM_EMAIL=noreply@example.com
```

### 多语言消息
已添加以下多语言消息：
- `email_verification_code` - 邮箱验证码
- `send_verification_code` - 发送验证码
- `verification_code_sent` - 验证码已发送
- `verification_code_required` - 请输入验证码
- `verification_code_invalid` - 验证码无效或已过期
- `verification_code_success` - 邮箱验证成功
- `enter_verification_code` - 请输入验证码
- `resend_verification_code` - 重新发送验证码
- `invalid_email` - 邮箱格式无效
- `email_send_failed` - 邮件发送失败

## 使用流程

1. 用户在注册或编辑资料页面填写邮箱
2. 勾选"邮件通知"选项
3. 系统显示验证码输入框和发送按钮
4. 点击"发送验证码"按钮
5. 系统生成验证码并发送到用户邮箱
6. 用户输入收到的验证码
7. 提交表单时系统验证验证码
8. 验证成功后完成注册或资料更新

## 注意事项

1. 验证码存储在内存中，服务器重启后会丢失
2. 生产环境建议使用Redis等缓存系统存储验证码
3. 邮件发送需要配置正确的SMTP服务器信息
4. 验证码有效期可以根据需要调整（当前为5分钟）
5. 倒计时时间可以根据需要调整（当前为60秒）

## 安全考虑

1. 验证码有效期限制防止长期有效
2. 验证成功后立即删除验证码
3. 倒计时机制防止频繁发送
4. 邮箱格式验证防止无效邮箱
5. 多语言支持确保用户体验
